box: ubuntu
build:
  steps:
    - script:
        name: create terraform directory and export PATH
        code: |
          mkdir -p $HOME/terraform
          export PATH=$PATH:$HOME/terraform
    - script:
        name: install wget / curl / unzip
        code: |
          apt-get update
          apt-get -y -qq install wget unzip curl
    - script:
        name: download terraform
        code: |
          cd $HOME/terraform
          TFVERSION=0.6.16
          wget https://releases.hashicorp.com/terraform/$TFVERSION/terraform_$TFVERSION_linux_amd64.zip
          unzip terraform_$TFVERSION_linux_amd64.zip
          rm terraform_$TFVERSION_linux_amd64.zip
    - script:
        name: run terraform plan
        code: |
          terraform plan \
            -refresh=false \
            -var 'access_key=AK123456789123456789' \
            -var 'secret_key=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' \
            -var 'ssh_key_name=your_ssh_key_name' \
            -var 'subnet=subnet-12345678' \
            -var 'securiy_group=sg-12345678' \
            -var 'iam_profile_name=your_iam_role_name' \
            -var 's3_bucket_name=your-s3-bucket-name' \
            -var 'datadog_api_key=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx' \
